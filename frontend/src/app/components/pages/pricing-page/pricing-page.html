<div class="pricing-page">
  <div class="pricing-container">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">Pricing</h1>
      <p class="page-subtitle">Transparent pricing for all our services</p>
    </div>

    <!-- View Switcher -->
    <div class="view-switcher">
      <button
        class="view-btn"
        [class.active]="currentView === 'services'"
        (click)="switchView('services')">
        Services
      </button>
      <button
        class="view-btn calculator-btn"
        [class.active]="currentView === 'calculator'"
        (click)="switchView('calculator')">
        Calculator
      </button>
    </div>

    <!-- Services View -->
    @if (currentView === 'services') {
      <div class="services-view">
        @for (category of categories; track category.id) {
          <div class="category-section">
            <!-- Category Header -->
            <button
              class="category-header"
              (click)="toggleCategory(category.id)">
              <h2>{{ category.name }}</h2>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                [class.rotated]="isCategoryExpanded(category.id)">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </button>

            <!-- Specializations -->
            @if (isCategoryExpanded(category.id)) {
              <div class="specializations">
                @for (specialization of category.specializations; track specialization.id) {
                  <div class="specialization-section">
                    <!-- Specialization Header -->
                    <button
                      class="specialization-header"
                      (click)="toggleSpecialization(specialization.id)">
                      <h3>{{ specialization.name }}</h3>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        [class.rotated]="isSpecializationExpanded(specialization.id)">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>

                    <!-- Items -->
                    @if (isSpecializationExpanded(specialization.id)) {
                      <div class="items-list">
                        @for (item of specialization.items; track item.id) {
                          <div
                            class="price-item"
                            (click)="addToCart(item, specialization, category)">
                            <span class="item-name">{{ item.name }}</span>
                            <div class="item-right">
                              <span class="item-price">€{{ item.price }}</span>
                              @if (isItemInCart(item.id)) {
                                <svg
                                  class="checkmark"
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="20"
                                  height="20"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  stroke="currentColor"
                                  stroke-width="3"
                                  stroke-linecap="round"
                                  stroke-linejoin="round">
                                  <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                              }
                            </div>
                          </div>
                        }
                      </div>
                    }
                  </div>
                }
              </div>
            }
          </div>
        }
      </div>
    }

    <!-- Calculator/Cart View -->
    @if (currentView === 'calculator') {
      <div class="calculator-view">
        @if (cart.length === 0) {
          <div class="empty-cart">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <p>Your cart is empty</p>
            <button class="back-to-services" (click)="switchView('services')">
              Browse Services
            </button>
          </div>
        } @else {
          <div class="cart-content">
            <!-- Cart Items -->
            <div class="cart-items">
              @for (cartItem of cart; track cartItem.item.id) {
                <div class="cart-item">
                  <div class="cart-item-info">
                    <span class="cart-item-name">{{ cartItem.item.name }}</span>
                    <span class="cart-item-category">{{ cartItem.specialization }}</span>
                  </div>
                  <div class="cart-item-right">
                    <span class="cart-item-quantity">{{ cartItem.quantity }}x</span>
                    <span class="cart-item-price">€{{ cartItem.item.price * cartItem.quantity }}</span>
                    <button
                      class="remove-btn"
                      (click)="removeFromCart(cartItem)">
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                      </svg>
                    </button>
                  </div>
                </div>
              }
            </div>

            <!-- Total Section -->
            <div class="cart-total">
              <span class="total-label">Total</span>
              <span class="total-amount">€{{ getTotalPrice() }}</span>
            </div>

            <!-- Discard All Button -->
            <button class="discard-all-btn" (click)="discardAll()">
              Discard All Items
            </button>
          </div>
        }
      </div>
    }
  </div>
</div>
